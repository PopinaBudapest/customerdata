<!DOCTYPE html>
<html>
<head>
  <title>Popina</title>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: sans-serif;
      font-size: 1.4rem;
      padding: 1rem;
      max-width: 480px;
      margin: auto;
    }

    .row {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    label {
      flex: 1;
      text-align: center;
      background: #f0f0f0;
      padding: 1rem 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      user-select: none;
    }

    input[type="radio"] {
      display: none;
    }

    input[type="radio"]:checked + span {
      background: #4caf50;
      color: white;
      border-radius: 6px;
      padding: 0.2rem 0.5rem;
    }

    span {
      display: inline-block;
      width: 100%;
    }

    button {
      font-size: 1.5rem;
      padding: 0.75rem;
      width: 100%;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    iframe {
      margin-top: 2rem;
    }
  </style>
</head>
<body>

  <form id="voteForm">

    <div class="row">
      <label><input type="radio" name="nationality" value="Hungarian"><span>Hungarian</span></label>
      <label><input type="radio" name="nationality" value="Other"><span>Other</span></label>
    </div>

    <div class="row">
      <label><input type="radio" name="group" value="1"><span>1</span></label>
      <label><input type="radio" name="group" value="2"><span>2</span></label>
      <label><input type="radio" name="group" value="3"><span>3</span></label>
      <label><input type="radio" name="group" value="4"><span>4</span></label>
      <label><input type="radio" name="group" value="4+"><span>4+</span></label>
    </div>

    <div class="row">
      <label><input type="radio" name="age" value="<18"><span>&lt;18</span></label>
      <label><input type="radio" name="age" value="18-25"><span>18–25</span></label>
      <label><input type="radio" name="age" value="26-35"><span>26–35</span></label>
      <label><input type="radio" name="age" value="36-50"><span>36–50</span></label>
      <label><input type="radio" name="age" value="50+"><span>50+</span></label>
    </div>

    <div class="row">
      <label><input type="radio" name="source" value="FB"><span>Facebook</span></label>
      <label><input type="radio" name="source" value="Maps"><span>Maps</span></label>
      <label><input type="radio" name="source" value="Insta"><span>Instagram</span></label>
      <label><input type="radio" name="source" value="Tiktok"><span>Tiktok</span></label>
      <label><input type="radio" name="source" value="Coupon"><span>Coupon</span></label>
      <label><input type="radio" name="source" value="Friend"><span>Friend</span></label>
      <label><input type="radio" name="source" value="Walk"><span>Walk-in</span></label>
      <label><input type="radio" name="source" value="Returning"><span>Returning</span></label>
    </div>

    <div class="row">
      <label><input type="radio" name="weather" value="sunny"><span>Sunny</span></label>
      <label><input type="radio" name="weather" value="cloudy"><span>Cloudy</span></label>
      <label><input type="radio" name="weather" value="rainy"><span>Rainy</span></label>
    </div>

    <div class="row">
      <label><input type="radio" name="temp" value="warm"><span>Warm</span></label>
      <label><input type="radio" name="temp" value="average"><span>Average</span></label>
      <label><input type="radio" name="temp" value="cold"><span>Cold</span></label>
    </div>

    <button type="submit">Submit</button>
  </form>

  <iframe id="sheetFrame" width="100%" height="500" frameborder="0"></iframe>

  <script src="config.js"></script>
  <script>
    document.getElementById('sheetFrame').src = CONFIG.sheetUrl;

    const getVal = (name) => {
      const selected = document.querySelector(`input[name="${name}"]:checked`);
      return selected ? selected.value : "";
    };

    document.getElementById('voteForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const data = {
        nationality: getVal("nationality"),
        group: getVal("group"),
        age: getVal("age"),
        source: getVal("source"),
        weather: getVal("weather"),
        temp: getVal("temp")
      };

      await fetch(CONFIG.apiUrl, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      e.target.reset();
    });
  </script>

</body>
</html>
